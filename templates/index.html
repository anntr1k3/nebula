{% extends "base.html" %}

{% block content %}
<div id="app" id="main-content">
  <div id="sidebar">
    <div id="user-info">
      <div class="username">üë§ {{ current_user.username }}</div>
      <div class="user-settings">
        <button id="theme-toggle" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è">
          <span class="theme-icon">üåô</span>
          <span class="theme-text">–°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É</span>
        </button>
        <button id="logout-btn" onclick="location.href='{{ url_for('logout') }}'" aria-label="–í—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞">–í—ã–π—Ç–∏</button>
      </div>
    </div>
    
    <div id="actions">
      <button id="search-user-btn" class="action-btn" aria-label="–ù–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –ª–∏—á–Ω–æ–≥–æ —á–∞—Ç–∞">üîç –ù–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
      <button id="create-group-btn" class="action-btn" aria-label="–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≥—Ä—É–ø–ø—É">‚ûï –°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É</button>
    </div>
    
    <h2>–ö–æ–º–Ω–∞—Ç—ã</h2>
    <ul id="rooms-list">
      {% for room in rooms %}
        <li data-room-id="{{ room.id }}" data-is-group="{{ room.is_group|lower }}" data-is-private="{{ room.is_private|lower }}">
          {% if room.is_private %}üí¨{% elif room.is_group %}üë•{% else %}#{% endif %} {{ room.name }}
        </li>
      {% endfor %}
    </ul>
  </div>

  <div id="chat-container">
    <div id="chat-header">
      <div id="room-title"></div>
      <div id="room-actions">
        <button id="invite-btn" style="display: none;">‚ûï –ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å</button>
        <button id="members-btn" style="display: none;">üë• –£—á–∞—Å—Ç–Ω–∏–∫–∏</button>
      </div>
    </div>
    
    <div id="connection-status"></div>
    
    <div id="messages"></div>
    
    <div id="typing-indicator"></div>
    
    <div id="input-area">
      <input 
        type="text" 
        id="message-input" 
        placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." 
        maxlength="500"
        autocomplete="off"
        aria-label="–ü–æ–ª–µ –≤–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏—è"
      />
      <span id="char-count">0/500</span>
      <button id="send-button" disabled aria-label="–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    </div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
<div id="search-modal" class="modal" role="dialog" aria-labelledby="search-modal-title" aria-hidden="true">
  <div class="modal-content" role="document">
    <button class="close" aria-label="–ó–∞–∫—Ä—ã—Ç—å">&times;</button>
    <h2 id="search-modal-title">–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
    <input type="text" id="search-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º..." autocomplete="off" aria-label="–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –Ω–∏–∫–Ω–µ–π–º—É" />
    <div id="search-results"></div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –≥—Ä—É–ø–ø—ã -->
<div id="group-modal" class="modal" role="dialog" aria-labelledby="group-modal-title" aria-hidden="true">
  <div class="modal-content" role="document">
    <button class="close" aria-label="–ó–∞–∫—Ä—ã—Ç—å">&times;</button>
    <h2 id="group-modal-title">–°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É</h2>
    <input type="text" id="group-name-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã..." maxlength="100" autocomplete="off" aria-label="–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–æ–≤–æ–π –≥—Ä—É–ø–ø—ã" />
    <button id="create-group-submit" aria-label="–°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø—É">–°–æ–∑–¥–∞—Ç—å</button>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –≤ –≥—Ä—É–ø–ø—É -->
<div id="invite-modal" class="modal" role="dialog" aria-labelledby="invite-modal-title" aria-hidden="true">
  <div class="modal-content" role="document">
    <button class="close" aria-label="–ó–∞–∫—Ä—ã—Ç—å">&times;</button>
    <h2 id="invite-modal-title">–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –≤ –≥—Ä—É–ø–ø—É</h2>
    <input type="text" id="invite-search-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫–Ω–µ–π–º..." autocomplete="off" aria-label="–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è" />
    <div id="invite-search-results"></div>
  </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ -->
<div id="members-modal" class="modal" role="dialog" aria-labelledby="members-modal-title" aria-hidden="true">
  <div class="modal-content" role="document">
    <button class="close" aria-label="–ó–∞–∫—Ä—ã—Ç—å">&times;</button>
    <h2 id="members-modal-title">–£—á–∞—Å—Ç–Ω–∏–∫–∏</h2>
    <div id="members-list"></div>
  </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.7.2/socket.io.js"></script>
<script src="{{ url_for('static', filename='js/animations.js') }}"></script>
<script src="{{ url_for('static', filename='js/main.js') }}"></script>
{% endblock %}
